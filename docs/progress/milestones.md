# 项目里程碑

## 里程碑时间线

```
设计阶段 ──────► 阶段一 ──────► 阶段二 ──────► 阶段三 ──────► 发布
   │               │               │               │               │
   ▼               ▼               ▼               ▼               ▼
 [进行中]        [1.5个月]       [1个月]        [2个月]        [TBD]
```

## M0: 设计阶段

**状态**: 进行中
**预计完成**: TBD

### 任务清单

- [x] 技术方案设计
- [x] 架构文档编写
- [x] API 规范定义
- [x] 研发路线图制定
- [ ] 技术选型确认
- [ ] 原型验证

### 交付物

- [x] README.md
- [x] CLAUDE.md
- [x] 架构文档
- [x] API 文档（草案）
- [ ] 技术选型报告
- [ ] 原型演示

## M1: 基础离线功能（阶段一）

**预计耗时**: 1.5 个月
**依赖**: M0 完成

### 目标

实现基本的离线数据读写和网络恢复后自动同步。

### 任务清单

#### Week 1-2: 项目初始化
- [ ] 创建项目结构
- [ ] 配置开发环境
- [ ] 搭建 CI/CD
- [ ] 编写 Hello World 演示

#### Week 3-4: 本地存储层
- [ ] 集成 RxDB/PouchDB
- [ ] 定义本地 Schema
- [ ] 实现基本的 CRUD 操作
- [ ] 编写单元测试

#### Week 5-6: 同步引擎
- [ ] 实现 Outbox 模式
- [ ] 实现网络状态监听
- [ ] 实现指数退避重试
- [ ] 实现基础 Push/Pull

#### Week 6-8: 服务端基础
- [ ] 搭建服务端框架
- [ ] 实现基础 API 端点
- [ ] 实现 Applier 模块
- [ ] 实现 LWW 冲突解决

#### Week 8-10: 联调与优化
- [ ] 客户端-服务端联调
- [ ] 端到端测试
- [ ] 性能优化
- [ ] Bug 修复

### 交付物

- [ ] 可运行的 MVP 演示
- [ ] 客户端 SDK v0.1.0
- [ ] 服务端 API v0.1.0
- [ ] 单元测试覆盖率 > 60%
- [ ] 部署文档

### 验收标准

- [ ] 离线状态下可以正常读写数据
- [ ] 网络恢复后自动同步
- [ ] 简单的 LWW 冲突可以自动解决
- [ ] 基本的用户操作流程完整

## M2: 流量优化（阶段二）

**预计耗时**: 1 个月
**依赖**: M1 完成

### 目标

实现增量同步和数据压缩，减少流量消耗。

### 任务清单

#### Week 1-2: 增量同步
- [ ] 服务端 change_log 实现
- [ ] Vector Clock / Merkle Tree 实现
- [ ] since 参数支持
- [ ] 游标分页

#### Week 3: 数据压缩
- [ ] Protobuf 定义
- [ ] Protobuf 编解码实现
- [ ] 性能对比测试

#### Week 4: 联调与优化
- [ ] 完整流程测试
- [ ] 流量统计
- [ ] 性能优化

### 交付物

- [ ] 客户端 SDK v0.2.0
- [ ] 服务端 API v0.2.0
- [ ] 性能测试报告

### 验收标准

- [ ] 只传输变更数据
- [ ] Protobuf 压缩率 > 40%
- [ ] 弱网环境下表现良好

## M3: 强一致性（阶段三）

**预计耗时**: 2 个月
**依赖**: M2 完成

### 目标

实现 CRDT 冲突解决和文件断点续传。

### 任务清单

#### Week 1-3: CRDT 集成
- [ ] Yjs/Automerge 选型
- [ ] CRDT 状态存储
- [ ] 服务端 CRDT 合并
- [ ] 字段级冲突解决

#### Week 4-6: 文件上传
- [ ] tus 协议服务端
- [ ] tus 协议客户端
- [ ] 分片上传实现
- [ ] 断点续传测试

#### Week 7-8: 高级功能
- [ ] WebSocket 实时推送
- [ ] 优先级队列
- [ ] 自适应分片

### 交付物

- [ ] 客户端 SDK v1.0.0
- [ ] 服务端 API v1.0.0
- [ ] 完整测试套件
- [ ] 生产部署文档

### 验收标准

- [ ] 字段级冲突自动合并
- [ ] 大文件断点续传
- [ ] WebSocket 实时同步
- [ ] 生产环境可用

## M4: 生产发布

**预计耗时**: TBD
**依赖**: M3 完成

### 目标

生产环境部署和监控。

### 任务清单

- [ ] 生产环境配置
- [ ] 监控和告警
- [ ] 灰度发布
- [ ] 性能测试
- [ ] 安全审计

### 交付物

- [ ] 生产环境
- [ ] 监控大盘
- [ ] 运维手册

## 关键决策点

| 决策点 | 截止时间 | 负责人 | 状态 |
|--------|---------|--------|------|
| 技术栈选型 | M0 结束前 | - | 🔴 待决策 |
| 首发平台 | M0 结束前 | - | 🔴 待决策 |
| CRDT 方案 | M2 开始前 | - | 🟡 待确认 |
| 生产环境 | M3 开始前 | - | 🟢 待规划 |
